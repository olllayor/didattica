{% extends 'teachers/teacherbase.html' %} 
{% load widget_tweaks %} 
{% load static %}
{% block content %}
<head>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'css/admin_view_student.css' %}"/>
</head>

<div id="message-container"></div>

<div class="content-wrapper">
  <div class="content-header">
    <h1 class="title">Available Questions</h1>
    <div class="update-info"></div>
  </div>
  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th>Questions</th>
          <th>Mark</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        {% for c in questions %}
        <tr>
          <td>{{c.question}}</td>
          <td>{{c.marks}}</td>
          <td class="actions">
            <a
                class="btn-delete"
                href="{% url 'remove-question' c.id  %}"
                data-id="{{ c.id }}"
                >
                <small class="fas fa-trash"></small>
            </a>
        </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="5">There are no question yet.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
<script>
    $(document).ready(function() {
        $('.btn-delete').click(function(e) {
            e.preventDefault();
            var deleteUrl = $(this).attr('href');
            var rowElement = $(this).closest('tr'); // Get the closest tr parent element

            $.ajax({
                url: deleteUrl,
                type: 'GET',
                success: function(response) {
                    if(response.status == 'success') {
                        rowElement.fadeOut(400, function() {
                            $(this).remove(); // Remove the row after fade out effect
                        });
                
                        // Add Bootstrap alert classes for styling the message
                        $('#message-container').html(
                            '<div class="alert alert-success text-center alert-dismissible fade show" role="alert">' +
                            response.message +
                            '<button type="button" class="close" data-dismiss="alert" aria-label="Close">' +
                            '<span aria-hidden="true">&times;</span>' +
                            '</button>' +
                            '</div>'
                        );
                        $('#message-container').show();
                    }
                },
                error: function(xhr, ajaxOptions, thrownError) {
                    if (xhr.status == 404) {
                        $('#message-container').html(
                            '<div class="alert alert-danger text-center alert-dismissible fade show" role="alert">' +
                            'The course could not be found or has already been deleted.' +
                            '<button type="button" class="close" data-dismiss="alert" aria-label="Close">' +
                            '<span aria-hidden="true">&times;</span>' +
                            '</button>' +
                            '</div>'
                        );
                        $('#message-container').show();
                    }
                }
            });
        });
    });
</script>

{% endblock %}
